# Processing of industry data from questionnaire survey regarding vessel and gear specifications

= Introduction =




= Details =

<code>

# paths
dataPath  <- file.path("C:","merging", "BENTHIS", "BENTHIS_WP2_WK_oct13")
outPath   <- file.path("C:","merging", "BENTHIS", "BENTHIS_WP2_WK_oct13")

# read file
ind <- read.table(file= file.path(dataPath, 'Only_OT_DTU Aqua_04102013.csv'), sep=",", header=TRUE )

# explore
ind [ind$Variable.name=="Trawl_model",]
levels(ind$Variable.name)
an <- function(x) as.numeric(as.character(x))


# subset some variables
CT  <- ind [ind$Variable.name=="Consumption_trawling", "Value"]
kW  <- ind [ind$Variable.name=="Vessel_kW", "Value"]
LOA <- ind [ind$Variable.name=="Vessel_LOA", "Value"]
df1 <- cbind.data.frame(CT, kW, LOA)

# refactor some variables (if needed)
df1$LOA_class <- cut(an(df1$LOA), breaks=c(0,15,100))

# plot (with ggplot2)
library(ggplot2)

p <- ggplot(data=df1, aes(an(kW),an(CT))) + geom_point(aes(shape = factor(LOA_class)))
update_labels(p, list(x = "kW", y="Consumption_trawling"))

coeff_lm <- coef(lm(an(CT) ~ an(kW) , data = df1))
p <- ggplot(data=df1, aes(an(kW),an(CT))) + geom_point(aes(size  = an(LOA))) + geom_abline(intercept = coeff_lm[1], slope = coeff_lm[2])
update_labels(p, list(x = "kW", y="Consumption_trawling"))
savePlot(file=file.path(outPath, "plot1.png"), type="png")


</code>





more advanced exploration....

<code>

# subset some variables
CT  <- ind [ind$Variable.name=="Consumption_trawling", "Value"]
kW  <- ind [ind$Variable.name=="Vessel_kW", "Value"]
LOA <- ind [ind$Variable.name=="Vessel_LOA", "Value"]
DoS <- ind [ind$Variable.name=="Door_spread", "Value"]
DoW <- ind [ind$Variable.name=="Door_weight", "Value"]
GrW <- ind [ind$Variable.name=="Groundgear_weight", "Value"]
sps <- ind [ind$Variable.name=="Targetspecies_single", "Value"]
sp1 <- ind [ind$Variable.name=="Primarytarget_mixed", "Value"]
sp2 <- ind [ind$Variable.name=="Secondarytarget_mixed", "Value"]
sp3 <- ind [ind$Variable.name=="Thirdtarget_mixed", "Value"]
bt  <- ind [ind$Variable.name=="Bottom_type", "Value"]
nbt <- ind [ind$Variable.name=="Trawl_number", "Value"]
df2 <- cbind.data.frame(CT, kW, LOA, DoS, DoW, GrW, sps, sp1, sp2, sp3, bt, nbt)


# DCF metier coding example
df2$metier <- as.character(df2$sps) # init
df2[df2$metier %in% c('NEP','PRA','Nephrops'), 'metier']   <- 'OT_CRU'
df2[df2$metier %in% c('COD','PLE','SOL', 'LEM'), 'metier'] <- 'OT_DMF'
df2[df2$metier %in% c('SAN','SPR'), 'metier']              <- 'OT_SPF'
df2[df2$metier %in% c('NR'), 'metier']                     <- 'OT_MIX'
df2$metier <- as.factor(df2$metier) 


# filter out
df3 <- df2[df2$sps!="NR",]  # single target
df4 <- df2[df2$sps=="NR",]  # mixte

# intermediate calculation
GrW <-  an(nbt) * an(GrW)

# plot DoS for single target
library(ggplot2)
coeff_lm <- coef(lm(an(DoS) ~ an(kW) , data = df3))
p <- ggplot(data=df3, aes(an(kW),an(DoS))) +
      geom_point(aes(shape  = factor(sps), color= factor(sps))) +
      geom_abline(intercept = coeff_lm[1], slope = coeff_lm[2])
update_labels(p, list(x = "kW", y="Door_spread"))
savePlot(file=file.path(outPath, "plot2.png"), type="png")

# plot DoS for single target
library(ggplot2)
coeff_lm <- coef(lm(an(DoS) ~ an(kW) , data = df3))
p <- ggplot(data=df3, aes(an(kW),an(DoS))) +
      geom_point() +
      geom_abline(intercept = coeff_lm[1], slope = coeff_lm[2]) +
      facet_grid(. ~ sps)
update_labels(p, list(x = "kW", y="Door_spread"))
savePlot(file=file.path(outPath, "plot3.png"), type="png")


# plot DoS for single target and bottom type (and door spread...too much dimension here!?)
library(ggplot2)
coeff_lm <- coef(lm(an(GrW) ~ an(kW) , data = df3))
p <- ggplot(data=df3, aes(an(kW),an(GrW))) +
       geom_point(aes(shape  = factor(sps), color= factor(bt), size=an(DoS))) +
       geom_abline(intercept = coeff_lm[1], slope = coeff_lm[2])
update_labels(p, list(x = "kW", y="Groundgear_weight"))
savePlot(file=file.path(outPath, "plot4.png"), type="png")


# plot for mixte targets
library(ggplot2)
coeff_lm <- coef(lm(an(DoS) ~ an(kW) , data = df4))
p <- ggplot(data=df4, aes(an(kW),an(DoS))) +
     geom_point(aes(color= factor(sp2))) +
     geom_abline(intercept = coeff_lm[1], slope = coeff_lm[2]) +
      facet_grid(. ~ sp1)
update_labels(p, list(x = "kW", y="Door_spread"))
savePlot(file=file.path(outPath, "plot5.png"), type="png")


</code>